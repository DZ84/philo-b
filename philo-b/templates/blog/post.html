{% extends "base.html" %}<!DOCTYPE html>
{% block css %}

	<style>
		.top-tag {
			text-align: left;
			margin-left: 5%;
			font-weight: bold;
		}
		
		.main-text-container {
			margin: 0 auto;
			width: 80%;
		}

		.separator-comment {
		}
	</style>

{% endblock css %}
{% block toptag %}	

	<div class="top-tag">Philo-b</div>

{% endblock toptag %}
{% block header %}

	{{ object.title }}

{% endblock header %}
{% block subheader %}

	{{ object.introduction }}

{% endblock subheader %}
{% block content %}

	<div class="main-text-container">
		{{ post.body }}
	</div>

{% endblock content %}
{% block comments %}
<!-- he keeps using something called |safe, what's that? -->
	<hr class="separator-comment">
	{% for comment in comments %}

		<div class="comments">
			<div class="date">{{ comment.pub_date }}</div>
			<strong>{{ comment.author_id }}</strong>
			<p>{{ comment.content|linebreaks }}</p>
			<a href="#comment-{{ comment.id }}">#</a>
			<hr>
			{% if form %}

				<a class="button" 
				   onclick="return show_comments_form({{ comment.id }})">reply comment?</a>

			{% endif %}
		</div>
		
	{% empty %}

		<p>No comments here yet :(</p>

	{% endfor %}
	{% if form %}

        <h3 id="write_comment"><a onclick="return show_comments_form('write_comment')">Write a comment.</a></h3>
		<form id="comment_form" action="{% url 'add_comment' post.id %}" method="POST">
			{% csrf_token %}
			{{ form.as_p }}
			<button type="submit" class="save">Save</button>
		</form>

	{% else %}

		<div class="no-login">
			<div class="no-login-heading">
				<h3 class="no-login-title"></h3>
			</div>
			<div class="no-login-body">
				Только авторизованные пользователи могут оставлять комментарии.<br />
			</div>
		</div>

	{% endif %}

{% endblock comments %}
{% block javascript %}

	<script>
		function show_comments_form(parent_comment_id) {
			if (parent_comment_id == 'write_comment') {
				$("#id_parent_comment").val('')
			}
			else {
				$("#id_parent_comment").val(parent_comment_id);
			}
			$("#comment_form").insertAfter("#" + parent_comment_id);
		}
	</script>

{% endblock javascript %}

